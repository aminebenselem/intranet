<app-header></app-header>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />

<section class="section gray-bg" id="contactus">
    <div class="container-fluid">
        <div class="row bg-sand">
            <div class="col-6" style="padding-left: 40px;">
                <div class="section-title">
                  <h2 *ngIf="role!='ROLE_USER'&&role!='ROLE_ADMIN'">Tous les reclamations</h2>
                  <h2 *ngIf="role=='ROLE_USER'||role=='ROLE_ADMIN'">Mes reclamations</h2>
              </div>
               </div>
            </div>
            <div class="col-md-7 col-lg-8 m-15px-tb">
                <div class="contact-form">
                     
                    <div class="inner-main-body p-2 p-sm-3 collapse forum-content show">
                      <div *ngFor="let forum of reclamations">
                        <div class="card mb-2"  *ngIf="role==forum.departement||forum.user?.mat_Pers==user">
                            <div class="card-body p-2 p-sm-3">
                                <div class="media forum-item">
                                    <a href="#" data-bs-toggle="collapse" data-bs-target=".forum-content"><img [src]="forum.user?.uri" class="mr-3 rounded-circle" width="50" alt="User" /></a>
                                    <div class="media-body">
                                        <h6><a href="#" [id]="forum.id" (click)="getForumByid($event);getReplies(forum.id)" data-bs-toggle="collapse" data-bs-target=".forum-content" class="text-body">{{forum.subject}}</a></h6>
                                        <p class="text-secondary">
                                            {{forum.message}}
                                        </p>
                                    </div>
                                    <div class="text-muted small text-center align-self-center">
                                        <span><i class="far fa-comment ml-2"></i>{{forum.replycount}}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                    <!-- /Forum List -->
        
                    <!-- Forum Detail -->
                    <div class="inner-main-body p-2 p-sm-3 collapse forum-content">
                        <a href="#" class="btn btn-light btn-sm mb-3 has-icon" data-bs-toggle="collapse" data-bs-target=".forum-content"><button class="btn" (click)="reload()"><i class="fa fa-arrow-left mr-2"></i>Back</button></a>
                        <div class="card mb-2">
                            <div class="card-body">
                                <div class="media forum-item">
                                    <a href="javascript:void(0)" class="card-link">
                                        <img [src]="forum1?.user?.uri" class="rounded-circle" width="50" alt="User" />
                                    </a>
                                    <div class="media-body ml-3">
                                        <a href="javascript:void(0)" class="text-secondary">{{forum1?.user.pren_PERS }}    {{forum1?.user.nom_PERS}}</a>
                                        <h5 class="mt-1"></h5>
                                        <div class="mt-3 font-size-sm">
                                            
                                            <p>
                                                {{forum1?.message}}
                                            </p>
                                            
                                        </div>
                                    </div>
                                    <div class="text-muted small text-center">
                                        <span><i class="far fa-comment ml-2"></i> {{forum1?.replycount}}</span>
                                    </div>
                                </div>
                            </div>
                             <div class="col-md-2" style="padding-bottom:5px;padding-left: 5px;">
                                <button (click)="open()" href="javascript:void(0)" class="btn btn-light btn-outline-primary">Commentaire</button>
                             </div>
                            
                                <div class="row" *ngIf="isopened==true">
                                    <div class="col-6">
                                        <div class="form-group" style="margin-left: 20px;margin-top: 10px;padding-bottom:5px;">
                                            <input id="subject"  [(ngModel)]="reply.body"  type="text" [ngModelOptions]="{standalone: true}"  type="text" placeholder="Ajouter un commentaire ..." class="form-control"> 
                                        </div>
                                        
                                    </div>
                                    <div class="col-md-2"><button [id]="forum1?.id" (click)="Reply();getReplies(forum1?.id);close();" class="btn btn-light" style="margin-top: 10px;"><i class="fa fa-sharp fa-shake fa-regular fa-arrow-right fa-sm" style="color: #4c4c4d;"></i></button> </div>
                                </div>
                            
        
                        </div>
                        <div class="card mb-2"  *ngFor="let reply of replies">
                            <div class="card-body">
                                <div class="media forum-item">
                                    <a href="javascript:void(0)" class="card-link">
                                        <img [src]="reply.user?.uri" class="rounded-circle" width="50" alt="User" />
                                        
                                    </a>
                                    <div class="media-body ml-3">
                                        <a href="javascript:void(0)" class="text-secondary">{{reply.user.nom_PERS}} {{reply.user.pren_PERS}}</a>
                                        <div class="mt-3 font-size-sm">
                                            <p>{{reply.body}}</p>
                                        </div>
                                       
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /Forum Detail -->
        
                    <!-- /Inner main body -->
                </div>
                <!-- /Inner main -->
            </div>
    </div>
</section>

<app-footer></app-footer>
